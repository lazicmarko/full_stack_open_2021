(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{44:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var r=n(1),s=n(19),a=n.n(s),c=n(2),o=n.n(c),i=n(4),u=n(3),l=n(10),d=n(0),b=function(e){var t=e.blog,n=e.user,s=e.handleLike,a=e.handleRemove,c=Object(r.useState)(!1),o=Object(u.a)(c,2),i=o[0],l=o[1],b={display:i?"":"none"};return Object(d.jsxs)("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},className:"blog",children:[Object(d.jsxs)("div",{className:"blog-heading",children:[t.title," - ",t.author," - ",Object(d.jsx)("button",{className:"view-button",onClick:function(){return l(!i)},children:i?"hide":"view"})]}),Object(d.jsxs)("div",{style:b,className:"blog-details",children:[Object(d.jsx)("div",{className:"url",children:t.url}),Object(d.jsxs)("div",{className:"likes",children:["likes ",t.likes," ",Object(d.jsx)("button",{className:"like-button",onClick:function(){return s(t.id)},children:"like"})]}),Object(d.jsx)("div",{children:t.user.name}),n.username===t.user.username&&Object(d.jsx)("button",{className:"remove-btn",onClick:function(){return a(t.id)},children:"remove"})]})]})},j=n(6),p=n.n(j),v="/api/blogs",f=null,g={getAll:function(){return p.a.get(v).then((function(e){return e.data}))},create:function(){var e=Object(i.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{authorization:f}},e.next=3,p.a.post(v,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){f="bearer ".concat(e)},update:function(){var e=Object(i.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{authorization:f}},e.next=3,p.a.put("".concat(v,"/").concat(t.id),t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(i.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{authorization:f}},e.next=3,p.a.delete("".concat(v,"/").concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};var h=function(e){var t=e.blogs,n=e.setBlogs,r=e.user,s=e.setMessage,a=e.resetMessage,c=function(){var e=Object(i.a)(o.a.mark((function e(r){var c,i,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.find((function(e){return e.id===r})),e.prev=1,e.next=4,g.update({id:c.id,title:c.title,author:c.author,url:c.url,likes:c.likes+1});case 4:i=e.sent,(u=Object(l.a)(t))[u.indexOf(c)]=i,n(u),s({text:"".concat(c.title," liked"),classname:"success"}),a(),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),s({text:e.t0.response.data.error,classname:"error"}),a();case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(i.a)(o.a.mark((function e(r){var c,i,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.find((function(e){return e.id===r})),console.log(c),!window.confirm("Remove blog ".concat(c.title,"! by ").concat(c.author))){e.next=18;break}return e.prev=3,e.next=6,g.remove(c.id);case 6:i=e.sent,console.log(i,"removed"),u=Object(l.a)(t),n(u.filter((function(e){return e.id!==c.id}))),s({text:"".concat(c.title," removed"),classname:"success"}),a(),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),s({text:e.t0.response.data.error,classname:"error"}),a();case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsx)("div",{id:"bloglist",children:t.sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(d.jsx)(b,{blog:e,user:r,resetMessage:a,setMessage:s,handleLike:c,handleRemove:u},e.id)}))})},x=function(e){var t=e.username,n=e.password,r=e.setUsername,s=e.setPassword,a=e.handleLogin;return Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"Log in to application"}),Object(d.jsxs)("form",{onSubmit:a,children:[Object(d.jsxs)("div",{children:["username",Object(d.jsx)("input",{type:"text",value:t,id:"username",onChange:function(e){var t=e.target;return r(t.value)}})]}),Object(d.jsxs)("div",{children:["password",Object(d.jsx)("input",{type:"password",value:n,id:"password",onChange:function(e){var t=e.target;return s(t.value)}})]}),Object(d.jsx)("button",{id:"login-button",type:"submit",children:"login"})]})]})},O={register:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};var m=function(e){var t=e.setMessage,n=e.resetMessage,s=e.blogFormRef,a=Object(r.useState)(""),c=Object(u.a)(a,2),l=c[0],b=c[1],j=Object(r.useState)(""),p=Object(u.a)(j,2),v=p[0],f=p[1],g=Object(r.useState)(""),h=Object(u.a)(g,2),x=h[0],m=h[1],w=function(){var e=Object(i.a)(o.a.mark((function e(r){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,O.register({name:l,password:x,username:v});case 4:a=e.sent,s.current.toggleVisibility(),t({text:"Successfully registered ".concat(a.name),classname:"success"}),n(),b(""),m(""),f(""),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0),t({text:e.t0.response.data.error,classname:"error"}),n();case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsx)("div",{children:Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"Register to application"}),Object(d.jsxs)("form",{onSubmit:w,children:[Object(d.jsxs)("div",{children:["name",Object(d.jsx)("input",{type:"text",value:l,id:"reg-name",onChange:function(e){var t=e.target;return b(t.value)}})]}),Object(d.jsxs)("div",{children:["username",Object(d.jsx)("input",{type:"text",value:v,id:"reg-username",onChange:function(e){var t=e.target;return f(t.value)}})]}),Object(d.jsxs)("div",{children:["password",Object(d.jsx)("input",{type:"password",value:x,id:"reg-password",onChange:function(e){var t=e.target;return m(t.value)}})]}),Object(d.jsx)("button",{id:"register-button",type:"submit",children:"register"})]})]})})},w=function(e){var t=e.blogs,n=e.setBlogs,s=e.setMessage,a=e.resetMessage,c=e.blogFormRef,l=Object(r.useState)(""),b=Object(u.a)(l,2),j=b[0],p=b[1],v=Object(r.useState)(""),f=Object(u.a)(v,2),h=f[0],x=f[1],O=Object(r.useState)(""),m=Object(u.a)(O,2),w=m[0],k=m[1],y=function(){var e=Object(i.a)(o.a.mark((function e(r){var i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,g.create({title:j,author:h,url:w});case 4:i=e.sent,c.current.toggleVisibility(),x(""),p(""),k(""),n(t.concat(i)),s({text:"A new blog ".concat(i.title," by ").concat(i.author," added."),classname:"success"}),a(),e.next=19;break;case 14:e.prev=14,e.t0=e.catch(1),s({text:e.t0.response.data.error,classname:"error"}),console.log(e.t0.response.data),a();case 19:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"Create new"}),Object(d.jsxs)("form",{onSubmit:y,children:[Object(d.jsxs)("div",{children:["title:",Object(d.jsx)("input",{id:"title",type:"text",value:j,onChange:function(e){var t=e.target;return p(t.value)}})]}),Object(d.jsxs)("div",{children:["author:",Object(d.jsx)("input",{id:"author",type:"text",value:h,onChange:function(e){var t=e.target;return x(t.value)}})]}),Object(d.jsxs)("div",{children:["url:",Object(d.jsx)("input",{id:"url",type:"text",value:w,onChange:function(e){var t=e.target;return k(t.value)}})]}),Object(d.jsx)("button",{id:"create-blog-button",type:"submit",children:"create"})]})]})},k=function(e){var t=e.message;return null===t?null:Object(d.jsx)("div",{className:t.classname,children:t.text})},y=Object(r.forwardRef)((function(e,t){var n=Object(r.useState)(!1),s=Object(u.a)(n,2),a=s[0],c=s[1],o={display:a?"none":""},i={display:a?"":"none"},l=function(){c(!a)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:l}})),Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{style:o,children:Object(d.jsx)("button",{onClick:l,children:e.buttonLabel})}),Object(d.jsxs)("div",{style:i,children:[e.children,Object(d.jsx)("button",{onClick:l,children:"cancel"})]})]})}));y.displayName="Togglable";var S=y,C={login:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},M=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)(""),c=Object(u.a)(a,2),l=c[0],b=c[1],j=Object(r.useState)(""),p=Object(u.a)(j,2),v=p[0],f=p[1],O=Object(r.useState)(null),y=Object(u.a)(O,2),M=y[0],N=y[1],L=Object(r.useState)(null),R=Object(u.a)(L,2),B=R[0],T=R[1],I=Object(r.useRef)();Object(r.useEffect)((function(){g.getAll().then((function(e){return s(e)})).catch((function(e){T({text:"Could not connect to server",classname:"error"}),console.log(e),U()}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedUser");if(e){var t=JSON.parse(e);N(t),g.setToken(t.token)}}),[]);var U=function(){return setTimeout((function(){return T(null)}),5e3)},F=function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,C.login({username:l,password:v});case 4:n=e.sent,window.localStorage.setItem("loggedUser",JSON.stringify(n)),g.setToken(n.token),N(n),T({text:"Welcome ".concat(n.name),classname:"success"}),U(),b(""),f(""),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),T({text:e.t0.response.data.error,classname:"error"}),U();case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();return M?Object(d.jsxs)("div",{children:[Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Bloglist app"}),Object(d.jsx)(k,{message:B}),M.name," logged in",Object(d.jsx)("button",{onClick:function(){window.localStorage.removeItem("loggedUser"),N(null),T({text:"Successfully logged out",classname:"success"}),U()},children:"logout"})]}),Object(d.jsx)(S,{buttonLabel:"new blog",ref:I,children:Object(d.jsx)(w,{blogs:n,setBlogs:s,setMessage:T,resetMessage:U,blogFormRef:I})}),Object(d.jsx)(h,{blogs:n,setBlogs:s,user:M,setMessage:T,resetMessage:U})]}):Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Bloglist app"}),Object(d.jsx)(k,{message:B}),Object(d.jsx)(S,{buttonLabel:"login",children:Object(d.jsx)(x,{username:l,setUsername:b,password:v,setPassword:f,handleLogin:F})}),Object(d.jsx)(S,{buttonLabel:"register",ref:I,children:Object(d.jsx)(m,{setMessage:T,resetMessage:U,blogFormRef:I})})]})};n(44);a.a.render(Object(d.jsx)(M,{}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.e5fb6be7.chunk.js.map